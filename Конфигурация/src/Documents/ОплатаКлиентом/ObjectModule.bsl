Процедура ОбработкаПроведения(Отказ, РежимПроведения)
    
    Движения.ВзаиморасчетыСКлиентами.Записывать = Истина;
    
    // Проверка заполнения и суммы
    Если Клиент.Пустая() Тогда
        Отказ = Истина;
        Сообщить("Не указан Клиент.");
        Возврат;
    КонецЕсли;
    
    Если ЭтотОбъект.Сумма <= 0 Тогда
        Отказ = Истина;
        Сообщить("Сумма оплаты должна быть больше нуля.");
        Возврат;
    КонецЕсли;
    
    // Создаем движение
    Движение = Движения.ВзаиморасчетыСКлиентами.Добавить();
    Движение.ВидДвижения = ВидДвиженияНакопления.Расход; 
    Движение.Период      = Дата;
    Движение.Клиент      = Клиент;
    // Оплата уменьшает общую задолженность клиента, регистрируется как Приход по регистру
    Движение.Сумма  = Сумма;
    
КонецПроцедуры